# Logistic Regression

- 머신러닝은 지도학습과 비지도학습으로 나뉨. 그리고 지도학습은 회귀와 분류로 나뉨. 회귀는 연속적인 값을 예측하고, 분류는 정해진 몇 개의 값 중 예측. 이번에는 분류 문제를 볼것. 어떤 이메일이 스팸인지 아닌지, 기사가 스포츠/정치/연애 기사중 어떤 것인지. 

  ![5_1](./resources/5_1.png)

  분류문제는 각 결과값에 어떤 숫자를 지정해줌. 

  <img src="./resources/5_2.png" alt="5_1" style="zoom:50%;" />

  사실은 선형회귀로도 분류를 할 수는 있음. 하단처럼 데이터가 있다면, 탈락은 0, 통과는 1로 나타냄. 그리고, 그 점들을 나타내는 가장 최적의 선을 찾음. 그 다음에 0.5를 넘으면 통과, 0.5 못넘으면 탈락 이런식으로 하면 됨. 

  <img src="./resources/5_3.png" alt="5_1" style="zoom:100%;" />

  ​	이렇게 간단하게 되는데도, 우리는 분류 문제를 풀 때, 선형회귀를 잘 사용하지 않음. 

  ​	왜냐하면, 위 데이터에서 갑자기 1000시간을 공부한 친구가 한명 있다고 해보자. 그러면 **이 데이터 딱 하나로 인해서 최적선이 갑자기 확 달라져버림**. 200시간이 아웃풋 0.5가 되는 지점이 되어 버림. 고작 데이터 하나 추가됬다고 100시간에서 200시간으로 늘어남. 선형회귀는 **이런 outlier에 너무 민감하게 반응함.** 보통 데이터 분류할때 잘 사용 안함. 

  <img src="./resources/5_4.png" alt="5_1" style="zoom:100%;" />





- #### Logistic Regression

   로지스틱 회귀. 선형회귀랑 어떻게 다를까? 선형회귀는 데이터에 가장 잘 맞는 1차함수를 찾는 것. 로지스틱 회귀는 **데이터에 가장 잘 맞는 시그모이드 함수를 찾는 것**. 

  시그모이드의 가장 중요한 특징은 0과 1 사이의 값을 리턴한다는 것. x에 무한대를 대입해도, 1로 접근함. x에 마이너스 무한대를 대입하면, 0에 접근함. 

  <img src="./resources/5_5.png" alt="5_5" style="zoom:100%;" />

  결과가 0과 1사이 라는것이 어떤 의미일까?

  - 선형회귀는 결과가 범위 없이 얼마든지 크거나 작아질 수 있기 때문에 분류를 하기에 부적합함. 
  - 시그모이드 함수는 항상 0과 1사이로 떨어지기 때문에 분류하기 편함. 아웃라이어 하나에 민감하게 변하지도 않음. 많이 동떨어진 데이터 하나가 있어도 그냥 1에 더 가까울 뿐 비슷함. 

  <img src="./resources/5_6.png" alt="5_5" style="zoom:100%;" />

  **그런데 로지스틱 회귀는 회귀가 아니고, 분류를 하는 것인데 왜 이름이 회귀일까?**

  사실 시그모이드의 결과값도 0과 1사이의 연속적인 값이기 때문에 회귀라고 볼 수 있음. 그것을 주로 0.5보다 큰지 작은지 보고 분류를 하는 것. 

  <img src="./resources/5_7.png" alt="5_5" style="zoom:100%;" />





- #### 로지스틱 회귀 가설함수

  가설함수란? 아래는 선형회귀에서의 가설함수. 

  <img src="./resources/5_8.png" alt="5_5" style="zoom:100%;" />

  선형회귀 가설함수를 조금만 발전시키면 로지스틱에서의 가설함수가 나옴. 

  선형회귀에서의 가설함수를 **h**, 로지스틱회귀에서의 가설함수를 **g**라고 놓는다. 

  <img src="./resources/5_9.png" alt="5_5" style="zoom:100%;" />

  함수 h안에 g를 대입하네?

  함수 g는 일차함수. 아웃풋이 엄청 클수도, 엄청 작을 수도 있음. 그런데 로지스틱 회귀를 할때에는 우리는 항상 아웃풋이 0과 1사이에 들어가야 함. 그러기 위해서, 시그모이드에 넣는 것. 시그모이드에는 어떤 인풋을 넣던 간에 아웃풋이 반드시 0과 1 사이로 떨어짐. 

  <img src="./resources/5_10.png" alt="5_5" style="zoom:100%;" />

  **그럼 우리가 0과 1사이의 값으로 뭘 하는 걸까?**

  0은 통과 못하는 것, 1은 통과 하는 것. x라는 벡터가 있을때, x1은 항상 1이니깐 무시하면 되고 x=50은 학생이 50시간 공부했다는 것을 의미. 대입했더니 0.9가 나왔다면?

  목표 변수가 1일 확률이 90% 라는 뜻. 즉 50시간을 공부할 학생이 시험을 통과할 확률이 **90%** 라는 것. 확률이 50%가 넘으니깐 분류를 하자면, 이 학생은 통과한 것으로 분류하자는 것. 아웃풋이 0.4라면 통과 못한 것으로 분류하자는 것. 

  <img src="./resources/5_11.png" alt="5_5" style="zoom:100%;" />

  